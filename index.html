<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jason | Portfolio</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&family=Space+Grotesk:wght@500;700&display=swap"
        rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Tone.js for True Pitch Shifting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <!-- Three.js for 3D Particle Globe -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>

<body>
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Particle Background Canvas -->
    <canvas id="particleCanvas"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none;"></canvas>

    <nav>
        <ul class="nav-links">
            <li><a href="#about">About Me</a></li>
            <li><a href="#skills">Skills</a></li>
            <li><a href="#experience">Experience</a></li>
            <li><a href="#projects">Projects</a></li>
            <li><a href="#contact">Contact Me</a></li>
        </ul>
    </nav>

    <!-- Theme Toggle Button (Fixed Position) -->
    <button id="themeToggle" class="theme-toggle">
        <span class="toggle-icon">ðŸŒ™</span>
        <span class="toggle-label">Mode</span>
    </button>

    <main class="container">
        <!-- About Section -->
        <section id="about">
            <div class="hero glass-panel">
                <div class="hero-content-wrapper">
                    <div class="profile-img-container">
                        <img src="assets/images/profile.jpg" alt="Jason Tran (JT)" class="profile-img">
                    </div>
                    <div class="hero-text">
                        <h1>Jason Tran</h1>
                        <div class="education-block">
                            <h3>California Institute of Technology, Pasadena, CA</h3>
                            <p>B.S, Electrical Engineering (Minor: Environmental Science Engineering)</p>
                            <p>Expected Graduation: 2027</p>
                        </div>

                        <p class="bio-text">
                            Electrical Engineering (Intelligent Systems) student with interests in machine learning and
                            building systems at the intersection of hardware, computation, and environmental science.
                            Experienced in sensing, robotics, RF systems, climate modeling, and data-driven engineering,
                            with a focus on real-world applications in sustainability, energy, and renewable
                            technologies.
                        </p>

                        <!-- Beyond Engineering Section -->
                        <div class="beyond-engineering"
                            style="margin-top: 2rem; opacity: 0; animation: fadeUp 0.8s ease-out 0.6s forwards;">
                            <h3 style="font-size: 1.1rem; color: var(--text-primary); margin-bottom: 1rem;">
                                <i class="fa-solid fa-heart" style="color: #ffffff;"></i> Beyond Engineering
                            </h3>

                            <!-- Hobbies Carousel -->
                            <div class="hobbies-carousel"
                                style="position: relative; overflow: hidden; border-radius: 12px; margin-bottom: 1.5rem;">
                                <div class="carousel-track" id="carouselTrack"
                                    style="display: flex; transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);">
                                    <!-- Slide 1: Beach -->
                                    <div class="carousel-slide" style="min-width: 100%; position: relative;">
                                        <img src="assets/images/hobbies/beach.png" alt="Beach"
                                            style="width: 100%; height: 220px; object-fit: cover; border-radius: 12px;">
                                        <div class="slide-caption"
                                            style="position: absolute; bottom: 0; left: 0; right: 0; padding: 1rem; background: linear-gradient(transparent, rgba(0,0,0,0.85)); border-radius: 0 0 12px 12px;">
                                            <p style="color: white; margin: 0; font-size: 0.9rem;">Love calm walks on
                                                the beach</p>
                                        </div>
                                    </div>
                                    <!-- Slide 2: Music -->
                                    <div class="carousel-slide" style="min-width: 100%; position: relative;">
                                        <img src="assets/images/hobbies/music.jpg" alt="Music"
                                            style="width: 100%; height: 220px; object-fit: cover; border-radius: 12px;">
                                        <div class="slide-caption"
                                            style="position: absolute; bottom: 0; left: 0; right: 0; padding: 1rem; background: linear-gradient(transparent, rgba(0,0,0,0.85)); border-radius: 0 0 12px 12px;">
                                            <p style="color: white; margin: 0; font-size: 0.9rem;">Music explorer â€“
                                                vinyl collector, concert-goer & lover of music analysis </p>
                                        </div>
                                    </div>
                                    <!-- Slide 3: Poetry -->
                                    <div class="carousel-slide" style="min-width: 100%; position: relative;">
                                        <img src="assets/images/hobbies/poetry.jpg" alt="Poetry"
                                            style="width: 100%; height: 220px; object-fit: cover; border-radius: 12px;">
                                        <div class="slide-caption"
                                            style="position: absolute; bottom: 0; left: 0; right: 0; padding: 1rem; background: linear-gradient(transparent, rgba(0,0,0,0.85)); border-radius: 0 0 12px 12px;">
                                            <p style="color: white; margin: 0; font-size: 0.9rem;">Reading, writing &
                                                enjoying poetry lounges in my free time </p>
                                        </div>
                                    </div>
                                    <!-- Slide 4: Traveling -->
                                    <div class="carousel-slide" style="min-width: 100%; position: relative;">
                                        <img src="assets/images/hobbies/traveling.jpg" alt="Traveling"
                                            style="width: 100%; height: 220px; object-fit: cover; border-radius: 12px;">
                                        <div class="slide-caption"
                                            style="position: absolute; bottom: 0; left: 0; right: 0; padding: 1rem; background: linear-gradient(transparent, rgba(0,0,0,0.85)); border-radius: 0 0 12px 12px;">
                                            <p style="color: white; margin: 0; font-size: 0.9rem;">Started traveling
                                                since college, wanting to explore new places</p>
                                        </div>
                                    </div>
                                    <!-- Slide 5: Sitcoms -->
                                    <div class="carousel-slide" style="min-width: 100%; position: relative;">
                                        <img src="assets/images/hobbies/television.jpg" alt="Television"
                                            style="width: 100%; height: 220px; object-fit: cover; border-radius: 12px;">
                                        <div class="slide-caption"
                                            style="position: absolute; bottom: 0; left: 0; right: 0; padding: 1rem; background: linear-gradient(transparent, rgba(0,0,0,0.85)); border-radius: 0 0 12px 12px;">
                                            <p style="color: white; margin: 0; font-size: 0.9rem;">Sitcom enthusiast -
                                                love Parks and Recreation, Arrested Development, and The Office</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Navigation Dots -->
                                <div class="carousel-dots"
                                    style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 0.75rem;">
                                    <button class="dot active" data-index="0"
                                        style="width: 8px; height: 8px; border-radius: 50%; border: none; background: white; cursor: pointer; transition: all 0.3s;"></button>
                                    <button class="dot" data-index="1"
                                        style="width: 8px; height: 8px; border-radius: 50%; border: none; background: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.3s;"></button>
                                    <button class="dot" data-index="2"
                                        style="width: 8px; height: 8px; border-radius: 50%; border: none; background: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.3s;"></button>
                                    <button class="dot" data-index="3"
                                        style="width: 8px; height: 8px; border-radius: 50%; border: none; background: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.3s;"></button>
                                    <button class="dot" data-index="4"
                                        style="width: 8px; height: 8px; border-radius: 50%; border: none; background: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.3s;"></button>
                                </div>
                            </div>

                            <!-- Vinyl Album 3D Carousel -->
                            <h4 style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 0.75rem;">
                                <i class="fa-solid fa-record-vinyl" style="color: #a855f7;"></i> Favorite Vinyls
                            </h4>
                            <div class="vinyl-carousel-container"
                                style="position: relative; height: 140px; display: flex; align-items: center; justify-content: center; perspective: 1000px; overflow: hidden; padding: 0 40px;">
                                <div class="vinyl-carousel-track" id="vinylTrack"
                                    style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                    <!-- Vinyl items are dynamically rendered by JavaScript -->
                                </div>
                                <!-- Navigation Arrows -->
                                <button class="vinyl-nav vinyl-prev" onclick="moveVinylCarousel(-1)"
                                    style="position: absolute; left: 0; background: rgba(255,255,255,0.1); border: none; color: white; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; font-size: 1rem; z-index: 20;">â€¹</button>
                                <button class="vinyl-nav vinyl-next" onclick="moveVinylCarousel(1)"
                                    style="position: absolute; right: 0; background: rgba(255,255,255,0.1); border: none; color: white; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; font-size: 1rem; z-index: 20;">â€º</button>
                            </div>

                            <!-- Audio Play Button (moved outside carousel container) -->
                            <div id="audioControls"
                                style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; width: 100%; text-align: center; margin-top: 1rem;">
                                <span
                                    style="font-size: 0.7rem; color: #a855f7; text-transform: uppercase; letter-spacing: 1px; font-weight: bold; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">Signal
                                    Audio Visual</span>
                                <button id="playBtn" class="glass-panel"
                                    style="border-radius: 50px; padding: 0.4rem 1.2rem; display: flex; align-items: center; gap: 0.5rem; cursor: pointer; border: 1px solid rgba(255, 255, 255, 0.2); background: rgba(0, 0, 0, 0.6);">
                                    <i class="fa-solid fa-play" id="playIcon"></i>
                                    <span style="font-size: 0.75rem;">Play Demo</span>
                                </button>
                            </div>

                            <!-- Audio Visualizer Canvas -->
                            <canvas id="visualizerCanvas"
                                style="width: 100%; height: 100px; margin-top: 1rem; display: none;"></canvas>

                            <!-- Pitch Control Slider -->
                            <div id="pitchControl"
                                style="display: none; margin-top: 1rem; padding: 0.75rem 1rem; background: rgba(255,255,255,0.05); border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <span
                                        style="font-size: 0.7rem; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 1px;">Pitch
                                        (Semitones)</span>
                                    <span id="pitchValue"
                                        style="font-size: 0.85rem; color: #a855f7; font-weight: 600;">0</span>
                                </div>
                                <input type="range" id="pitchSlider" min="-12" max="12" step="1" value="0"
                                    class="pitch-slider">
                            </div>
                        </div>
                    </div>
                </div>
        </section>

        <script>
            // Hobbies Carousel
            const track = document.getElementById('carouselTrack');
            const dots = document.querySelectorAll('.dot');
            let currentIndex = 0;
            const totalSlides = 5;
            let autoPlay;

            function goToSlide(index) {
                currentIndex = index;
                track.style.transform = `translateX(-${index * 100}%)`;
                dots.forEach((dot, i) => {
                    dot.style.background = i === index ? 'white' : 'rgba(255,255,255,0.4)';
                });
            }

            function nextSlide() {
                currentIndex = (currentIndex + 1) % totalSlides;
                goToSlide(currentIndex);
            }

            // Auto-rotate every 4 seconds
            function startAutoPlay() {
                autoPlay = setInterval(nextSlide, 4000);
            }

            // Pause on hover
            const carousel = document.querySelector('.hobbies-carousel');
            carousel.addEventListener('mouseenter', () => clearInterval(autoPlay));
            carousel.addEventListener('mouseleave', startAutoPlay);

            // Dot navigation
            dots.forEach(dot => {
                dot.addEventListener('click', () => {
                    goToSlide(parseInt(dot.dataset.index));
                });
            });

            startAutoPlay();

            // Vinyl 3D Carousel - Infinite/Virtual Rendering
            // All vinyl data stored in array
            const vinyls = [
                { img: 'assets/images/hobbies/blonded.jpg', title: 'Blonde', audio: 'assets/audio/blonde.mp3' },
                { img: 'assets/images/hobbies/channel orange.jpg', title: 'Channel Orange', audio: 'assets/audio/channel_orange.mp3' },
                { img: 'assets/images/hobbies/igor.jpg', title: 'IGOR', audio: 'assets/audio/igor.mp3' },
                { img: 'assets/images/hobbies/ok computer.png', title: 'OK Computer', audio: 'assets/audio/ok_computer.mp3' },
                { img: 'assets/images/hobbies/so tonight i might see.jpg', title: 'So Tonight...', audio: 'assets/audio/so_tonight.mp3' }
            ];

            let vinylCurrentIndex = 2; // Start at center (IGOR)
            const vinylTotal = vinyls.length;
            const vinylTrack = document.getElementById('vinylTrack');

            // Create a vinyl element
            function createVinylElement(vinyl, isActive, displayIndex) {
                const div = document.createElement('div');
                div.className = 'vinyl-3d-item' + (isActive ? ' active' : '');
                div.innerHTML = `<img src="${vinyl.img}" alt="${vinyl.title}"><p>${vinyl.title}</p>`;

                // Click to navigate to this item
                div.addEventListener('click', () => {
                    const diff = displayIndex - 2; // 2 is center position
                    if (diff !== 0) moveVinylCarousel(diff);
                });

                return div;
            }

            // Render only 5 vinyls centered on current
            function renderVinylCarousel() {
                vinylTrack.innerHTML = '';

                // Show 5 items: indices -2, -1, 0, +1, +2 relative to current
                for (let offset = -2; offset <= 2; offset++) {
                    const idx = (vinylCurrentIndex + offset + vinylTotal) % vinylTotal;
                    const isActive = offset === 0;
                    const vinyl = createVinylElement(vinyls[idx], isActive, offset + 2);
                    vinylTrack.appendChild(vinyl);
                }
            }

            // Move carousel (will be wrapped to stop audio when changing)
            function moveVinylCarousel(direction) {
                vinylCurrentIndex = (vinylCurrentIndex + direction + vinylTotal) % vinylTotal;
                renderVinylCarousel();
            }

            // Initialize carousel
            renderVinylCarousel();

            // Audio Player & Visualizer
            const playBtn = document.getElementById('playBtn');
            const playIcon = document.getElementById('playIcon');
            const audioControls = document.getElementById('audioControls');
            const vizCanvas = document.getElementById('visualizerCanvas');
            const vizCtx = vizCanvas.getContext('2d');

            let analyser;
            let tonePlayer;
            let pitchShift;
            let isPlaying = false;
            let animationId;


            playBtn.addEventListener('click', togglePlay);

            function togglePlay() {
                if (!isPlaying) {
                    startAudio();
                } else {
                    stopAudio();
                }
            }

            function startAudio() {
                // Initialize Tone.js context on user gesture
                Tone.start();

                // Create Tone.js player
                tonePlayer = new Tone.Player({
                    url: vinyls[vinylCurrentIndex].audio,
                    loop: true,
                    autostart: false
                });

                // Create pitch shift effect (true pitch shifting without speed change)
                pitchShift = new Tone.PitchShift(0); // Start at 0 semitones

                // Create analyser for visualization (connects to Web Audio API analyser)
                if (!analyser) {
                    analyser = Tone.context.createAnalyser();
                    analyser.fftSize = 4096;
                }

                // Connect: Player -> PitchShift -> Analyser -> Destination
                tonePlayer.connect(pitchShift);
                pitchShift.connect(analyser);
                Tone.connect(analyser, Tone.Destination);

                // Start playback when loaded
                tonePlayer.autostart = true;

                // UI Updates - Show pitch control
                isPlaying = true;
                playIcon.classList.remove('fa-play');
                playIcon.classList.add('fa-pause');
                vizCanvas.style.display = 'block';
                document.getElementById('pitchControl').style.display = 'block';
                document.querySelector('.vinyl-3d-item.active img').style.animation = 'spin 4s linear infinite';

                // Connect pitch slider (semitones: -12 to +12)
                const pitchSlider = document.getElementById('pitchSlider');
                const pitchValueDisplay = document.getElementById('pitchValue');
                pitchSlider.value = 0;
                pitchValueDisplay.textContent = '0';

                pitchSlider.oninput = function () {
                    const semitones = parseInt(this.value);
                    pitchShift.pitch = semitones;
                    pitchValueDisplay.textContent = (semitones > 0 ? '+' : '') + semitones;
                };

                drawVisualizer();
            }

            function stopAudio() {
                if (tonePlayer) {
                    tonePlayer.stop();
                    tonePlayer.dispose();
                    tonePlayer = null;
                }
                if (pitchShift) {
                    pitchShift.dispose();
                    pitchShift = null;
                }

                // UI Updates - Hide pitch control
                isPlaying = false;
                playIcon.classList.remove('fa-pause');
                playIcon.classList.add('fa-play');
                cancelAnimationFrame(animationId);
                vizCanvas.style.display = 'none';
                document.getElementById('pitchControl').style.display = 'none';
                document.querySelector('.vinyl-3d-item.active img').style.animation = 'none';
            }

            function drawVisualizer() {
                vizCanvas.width = vizCanvas.offsetWidth;
                vizCanvas.height = vizCanvas.offsetHeight;

                vizCtx.clearRect(0, 0, vizCanvas.width, vizCanvas.height);

                const bufferLength = analyser.frequencyBinCount;
                const halfHeight = vizCanvas.height / 2;

                // === TIME DOMAIN (Waveform) - Top half ===
                const timeData = new Uint8Array(bufferLength);
                analyser.getByteTimeDomainData(timeData);

                const gradient = vizCtx.createLinearGradient(0, 0, vizCanvas.width, 0);
                const isEco = document.body.classList.contains('eco-mode');
                if (isEco) {
                    gradient.addColorStop(0, '#84cc16');
                    gradient.addColorStop(0.5, '#10b981');
                    gradient.addColorStop(1, '#22c55e');
                } else {
                    gradient.addColorStop(0, '#22d3ee');
                    gradient.addColorStop(0.5, '#a855f7');
                    gradient.addColorStop(1, '#e879f9');
                }

                vizCtx.lineWidth = 2;
                vizCtx.strokeStyle = gradient;
                vizCtx.shadowBlur = 8;
                vizCtx.shadowColor = isEco ? '#10b981' : '#a855f7';
                vizCtx.beginPath();

                const sliceWidth = vizCanvas.width / bufferLength;
                let x = 0;

                const amplify = 2.5;
                for (let i = 0; i < bufferLength; i++) {
                    const v = (timeData[i] / 128.0 - 1) * amplify;
                    const y = (v + 1) * halfHeight / 2; // Top half only
                    if (i === 0) vizCtx.moveTo(x, y);
                    else vizCtx.lineTo(x, y);
                    x += sliceWidth;
                }

                vizCtx.lineTo(vizCanvas.width, halfHeight / 2);
                vizCtx.stroke();
                vizCtx.shadowBlur = 0;

                // === FREQUENCY DOMAIN (FFT) - Bottom half ===
                const freqData = new Uint8Array(bufferLength);
                analyser.getByteFrequencyData(freqData);

                const numBars = 64;
                const barWidth = vizCanvas.width / numBars;

                for (let i = 0; i < numBars; i++) {
                    const barHeight = (freqData[i] / 255) * halfHeight * 0.9;
                    const barX = i * barWidth;
                    const barY = vizCanvas.height - barHeight;

                    // Gradient from cyan (bass) to purple (mids)
                    const hue = 180 + (i / numBars) * 80;
                    vizCtx.fillStyle = `hsla(${hue}, 80%, 60%, 0.6)`;
                    vizCtx.fillRect(barX, barY, barWidth - 1, barHeight);
                }

                animationId = requestAnimationFrame(drawVisualizer);
            }

            // Stop audio if vinyl is changed
            const originalMoveVinyl = moveVinylCarousel;
            moveVinylCarousel = function (direction) {
                if (isPlaying) stopAudio();
                originalMoveVinyl(direction);
            }
        </script>

        <!-- Skills Section -->
        <section id="skills">
            <h2 class="section-title reveal">My Skills</h2>

            <div class="skills-grid reveal-stagger">
                <!-- Category 1 -->
                <div class="glass-panel skill-card">
                    <i class="fa-solid fa-code skill-icon"></i>
                    <h3>Programming & ML</h3>
                    <p class="skill-list">Python, Arduino, Java, Julia, MATLAB, ROS2, PyTorch/TensorFlow, Linux/Bash</p>
                </div>
                <!-- Category 2 -->
                <div class="glass-panel skill-card">
                    <i class="fa-solid fa-chart-simple skill-icon"></i>
                    <h3>Scientific Computing</h3>
                    <p class="skill-list">NumPy, SciPy, Pandas, Matplotlib, Scikit-learn, OpenCV, Jupyter/Colab,
                        Git/GitHub</p>
                </div>
                <!-- Category 3 -->
                <div class="glass-panel skill-card">
                    <i class="fa-solid fa-microchip skill-icon"></i>
                    <h3>Hardware & Embedded</h3>
                    <p class="skill-list">LTspice, Altium, Raspberry Pi Pico/MicroPython, I2C/SPI, PCB design,
                        Soldering, Oscilloscopes</p>
                </div>
                <!-- Category 4 -->
                <div class="glass-panel skill-card">
                    <i class="fa-solid fa-gears skill-icon"></i>
                    <h3>Mechanical & CAD</h3>
                    <p class="skill-list">SolidWorks, 3D Printing (FDM/SLA), Laser/Waterjet cutting, Lathe & Mill
                        operation</p>
                </div>
                <!-- Category 5 -->
                <div class="glass-panel skill-card">
                    <i class="fa-solid fa-wifi skill-icon"></i>
                    <h3>RF & Sensor Systems</h3>
                    <p class="skill-list">AutoCAD/Solidworks, Radar/RF Hardware (Waveguides, LNAs), IR Sensors, Motor
                        Drivers</p>
                </div>
                <!-- Category 6 -->
                <div class="glass-panel skill-card">
                    <i class="fa-brands fa-microsoft skill-icon"></i>
                    <h3>Productivity Tools</h3>
                    <p class="skill-list">Microsoft Word, Excel, Visio, PowerPoint</p>
                </div>
            </div>
        </section>

        <!-- Professional Experience Section -->
        <section id="experience">
            <h2 class="section-title reveal">Professional Experience</h2>
            <div class="experience-container reveal-stagger">
                <!-- Experience Card 1: NASA JPL -->
                <div class="glass-panel experience-card">
                    <div class="experience-content">
                        <div class="exp-header">
                            <div class="exp-icon-box">
                                <i class="fa-solid fa-satellite"></i>
                            </div>
                            <div>
                                <h3 class="exp-role">Cloud and Precipitation Airborne Radar Development</h3>
                                <h4 class="exp-company">NASA Jet Propulsion Laboratory (JPL)</h4>
                            </div>
                        </div>

                        <div class="exp-meta">
                            <span><i class="fa-solid fa-location-dot"></i> Pasadena, CA</span>
                            <span class="separator">â€¢</span>
                            <span><i class="fa-regular fa-calendar"></i> May 2025 â€“ July 2025</span>
                        </div>

                        <ul class="exp-details">
                            <li><i class="fa-solid fa-arrow-right-long"></i> Supported the design upgrade of the
                                multi-frequency CloudCube/APR-3 airborne radar system and participated in Radar
                                Development Meetings to review architecture changes and subsystem interfaces.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Updated subsystem block diagrams in Visio
                                to document new RF, electrical, and optical paths; assisted with integration planning
                                and system-level configuration.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Worked with RF engineers on chain upgrades
                                involving mixers, LNAs, IF routing, and waveguide components; performed lab testing with
                                signal and spectrum analyzers to validate gain, continuity, and signal quality.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Produced CAD models for radar-optics
                                alignment and designed custom mechanical interface plates to fit the upgraded radar
                                assembly into a new aircraft payload bay.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Assisted with troubleshooting during
                                integration and testing, contributing to improved instrument reliability and
                                higher-quality cloud and precipitation data products.</li>
                        </ul>
                    </div>
                </div>

                <!-- Experience Card 2: Green Labs -->
                <div class="glass-panel experience-card">
                    <div class="experience-content">
                        <div class="exp-header">
                            <div class="exp-icon-box">
                                <i class="fa-solid fa-leaf"></i>
                            </div>
                            <div>
                                <h3 class="exp-role">Green Labs Associate & Sustainability Research Intern</h3>
                                <h4 class="exp-company">Caltech Green Labs</h4>
                            </div>
                        </div>

                        <div class="exp-meta">
                            <span><i class="fa-solid fa-location-dot"></i> Pasadena, CA</span>
                            <span class="separator">â€¢</span>
                            <span><i class="fa-regular fa-calendar"></i> Sept 2025 â€“ Present</span>
                        </div>

                        <ul class="exp-details">
                            <li><i class="fa-solid fa-arrow-right-long"></i> Conduct lab energy audits to identify
                                power, equipment, and material inefficiencies; track energy and waste costs to help
                                reduce operational expenses across campus laboratories.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Lead personal waste-reduction research in
                                Engineering & Applied Science (EAS) & AI labs, analyzing waste streams in engineering
                                environments and developing recommendations to minimize material and equipment waste.
                            </li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Operates Caltech's ReStore program,
                                cataloging and organizing donated lab equipment to improve inventory tracking and expand
                                equipment reuse.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Support sustainability outreach and create
                                best-practice guides to help labs adopt low-waste, energy-efficient workflows.</li>
                        </ul>
                        <a href="https://www.labmanager.com/caltech-launches-green-labs-restore-to-rehome-surplus-lab-supplies-34701"
                            target="_blank" class="btn btn-sm" style="margin-top: 1rem;">
                            <i class="fa-solid fa-newspaper"></i> Featured in Lab Manager
                        </a>
                    </div>
                </div>

                <!-- Experience Card 3: Climate Modeling -->
                <div class="glass-panel experience-card">
                    <div class="experience-content">
                        <div class="exp-header">
                            <div class="exp-icon-box">
                                <i class="fa-solid fa-cloud"></i>
                            </div>
                            <div>
                                <h3 class="exp-role">Climate Modeling Research Intern</h3>
                                <h4 class="exp-company">Climate Modeling Alliance (MITâ€“Caltechâ€“JPL)</h4>
                            </div>
                        </div>

                        <div class="exp-meta">
                            <span><i class="fa-solid fa-location-dot"></i> Pasadena, CA</span>
                            <span class="separator">â€¢</span>
                            <span><i class="fa-regular fa-calendar"></i> Oct 2025 â€“ Present</span>
                        </div>

                        <ul class="exp-details">
                            <li><i class="fa-solid fa-arrow-right-long"></i> Contribute to the Climate Modeling Alliance
                                (CliMA) through development and testing of open-source Julia models
                                CloudMicrophysics.jl, KinematicDriver.jl used for simulating cloud microphysics and
                                atmospheric convection.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Maintain the KinematicDriver.jl codebase
                                and explore single- and double-moment microphysics schemes to improve the accuracy and
                                stability of climate simulations.</li>
                        </ul>
                    </div>
                </div>

                <!-- Experience Card 4: Solar Car Club -->
                <div class="glass-panel experience-card">
                    <div class="experience-content">
                        <div class="exp-header">
                            <div class="exp-icon-box">
                                <i class="fa-solid fa-solar-panel"></i>
                            </div>
                            <div>
                                <h3 class="exp-role">Solar Car Club â€“ Electrical Engineering Team</h3>
                                <h4 class="exp-company">University of the Pacific</h4>
                            </div>
                        </div>

                        <div class="exp-meta">
                            <span><i class="fa-solid fa-location-dot"></i> Stockton, CA</span>
                            <span class="separator">â€¢</span>
                            <span><i class="fa-regular fa-calendar"></i> Aug 2022 â€“ Jan 2023</span>
                        </div>

                        <ul class="exp-details">
                            <li><i class="fa-solid fa-arrow-right-long"></i> Contributed to the design of electrical
                                power and energy systems for a life-size solar car in the American Solar Challenge.</li>
                            <li><i class="fa-solid fa-arrow-right-long"></i> Assisted with integration of batteries,
                                solar cells, and fuses; tested flexible/convex solar configurations with tracking
                                sensors to enhance energy capture.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Projects Section -->
        <section id="projects">
            <h2 class="section-title reveal">Featured Projects</h2>
            <div class="projects-grid reveal-stagger">
                <!-- Project 1 -->
                <div class="glass-panel project-card">
                    <div class="project-image" style="background: linear-gradient(45deg, #10b981, #0ea5e9);">
                        <i class="fa-solid fa-robot"
                            style="font-size: 3rem; color: white; opacity: 0.8; height: 100%; display: flex; align-items: center; justify-content: center;"></i>
                    </div>
                    <div class="project-content">
                        <h3 class="project-title">Autonomous Mobile Robot (Ricotta)</h3>
                        <p class="project-description">
                            Autonomous robot with IR/Ultrasonic sensing, path planning (Dijkstra), and PID control.
                        </p>
                        <div class="tech-stack">
                            <span class="tech-tag">Python</span>
                            <span class="tech-tag">Raspberry Pi</span>
                            <span class="tech-tag">Arduino</span>
                        </div>
                        <a href="projects/ricotta.html" class="btn btn-sm">View Details & Code</a>
                    </div>
                </div>

                <!-- Project 2 -->
                <div class="glass-panel project-card">
                    <div class="project-image" style="background: linear-gradient(45deg, #f59e0b, #ef4444);">
                        <i class="fa-solid fa-music"
                            style="font-size: 3rem; color: white; opacity: 0.8; height: 100%; display: flex; align-items: center; justify-content: center;"></i>
                    </div>
                    <div class="project-content">
                        <h3 class="project-title">Voltage-to-Frequency Piano</h3>
                        <p class="project-description">
                            Analog circuit design simulating a piano using Voltage-Controlled Oscillators (VCOs).
                        </p>
                        <div class="tech-stack">
                            <span class="tech-tag">Analog Circuits</span>
                            <span class="tech-tag">LTSpice</span>
                            <span class="tech-tag">Signal Processing</span>
                        </div>
                        <a href="projects/piano.html" class="btn btn-sm">View Details</a>
                    </div>
                </div>

                <!-- Project 3 -->
                <div class="glass-panel project-card">
                    <div class="project-image" style="background: linear-gradient(45deg, #8b5cf6, #3b82f6);">
                        <i class="fa-solid fa-brain"
                            style="font-size: 3rem; color: white; opacity: 0.8; height: 100%; display: flex; align-items: center; justify-content: center;"></i>
                    </div>
                    <div class="project-content">
                        <h3 class="project-title">CBOW Word Embeddings</h3>
                        <p class="project-description">
                            NLP model implementing the Continuous Bag of Words architecture to generating word
                            embeddings.
                        </p>
                        <div class="tech-stack">
                            <span class="tech-tag">NLP</span>
                            <span class="tech-tag">Python</span>
                            <span class="tech-tag">PyTorch</span>
                        </div>
                        <a href="https://colab.research.google.com/drive/12DEFaGarP8W7ngRE_OZAvbtWyHJ2xNHm?usp=sharing"
                            target="_blank" class="btn btn-sm"><i class="fa-brands fa-google"></i> Open in Colab</a>
                    </div>
                </div>

                <!-- Project 3 -->
                <div class="glass-panel project-card">
                    <div class="project-image" style="background: linear-gradient(45deg, #f59e0b, #ec4899);">
                        <i class="fa-solid fa-robot"
                            style="font-size: 3rem; color: white; opacity: 0.8; height: 100%; display: flex; align-items: center; justify-content: center;"></i>
                    </div>
                    <div class="project-content">
                        <h3 class="project-title">Humanoid Tennis Manipulation (ROS 2)</h3>
                        <p class="project-description">
                            Developed a ROS 2 humanoid tennis manipulation system using hybrid IK: Newton-Raphson for
                            target solving, damped least-squares for real-time tracking. 100 Hz controller with quintic
                            trajectories.
                        </p>
                        <div class="tech-stack">
                            <span class="tech-tag">ROS 2</span>
                            <span class="tech-tag">Python</span>
                            <span class="tech-tag">Inverse Kinematics</span>
                        </div>
                        <a href="https://github.com/sromeror58/project_ws" target="_blank" class="btn btn-sm"><i
                                class="fa-brands fa-github"></i> View on GitHub</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact">
            <h2 class="section-title reveal">Get In Touch</h2>
            <div class="contact-grid reveal-stagger">
                <!-- Left Column: Contact Info + Spotify -->
                <div class="contact-left-column">
                    <!-- Contact Info Bubble -->
                    <div class="glass-panel contact-info text-center">
                        <h3>Contact Info</h3>
                        <div class="info-item">
                            <i class="fa-solid fa-envelope info-icon"></i>
                            <p><a href="mailto:jhtran@caltech.edu" class="contact-link">jhtran@caltech.edu</a></p>
                        </div>
                        <div class="info-item">
                            <i class="fa-solid fa-location-dot info-icon"></i>
                            <p>Pasadena, CA & Stockton, CA</p>
                        </div>
                        <div class="info-item">
                            <i class="fa-regular fa-clock info-icon"></i>
                            <p><span id="liveClock">--:-- --</span> in Pasadena</p>
                        </div>
                    </div>

                    <!-- Spotify Now Playing -->
                    <div class="glass-panel spotify-widget">
                        <h3><i class="fa-brands fa-spotify" style="color: #1DB954;"></i> Now Playing</h3>
                        <iframe style="border-radius:12px"
                            src="https://open.spotify.com/embed/track/3hRV0jL3vUpRrcy398teAU?utm_source=generator&theme=0"
                            width="100%" height="152" frameBorder="0" allowfullscreen=""
                            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                            loading="lazy">
                        </iframe>
                    </div>
                </div>

                <!-- Contact Form Bubble -->
                <div class="glass-panel contact-form">
                    <h3>Send a Message</h3>
                    <!-- Formspree Endpoint -->
                    <form action="https://formspree.io/f/xblnerpj" method="POST">
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input type="text" id="name" name="name" required placeholder="Your Name">
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" required placeholder="Your Email">
                        </div>
                        <div class="form-group">
                            <label for="subject">Subject</label>
                            <input type="text" id="subject" name="subject" required placeholder="Subject">
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea id="message" name="message" rows="5" required
                                placeholder="Your Message"></textarea>
                        </div>
                        <button type="submit" class="btn btn-full">Send Message</button>
                    </form>
                </div>
            </div>

            <!-- Social Icons -->
            <div class="social-icons-row reveal">
                <a href="https://github.com/jahuytee" target="_blank" class="social-icon-link" title="GitHub">
                    <i class="fa-brands fa-github"></i>
                </a>
                <a href="https://linkedin.com/in/jhtran1" target="_blank" class="social-icon-link" title="LinkedIn">
                    <i class="fa-brands fa-linkedin"></i>
                </a>
                <a href="https://open.spotify.com/user/22gyhbpasubyow2igf7sisewy?si=391f056954fe47f2" target="_blank"
                    class="social-icon-link" title="Spotify">
                    <i class="fa-brands fa-spotify"></i>
                </a>
                <button class="social-icon-link" onclick="copyToClipboard('jasonhuytran', this)"
                    title="Discord - Click to copy">
                    <i class="fa-brands fa-discord"></i>
                </button>
            </div>
        </section>
    </main>

    <!-- 3D Particle Globe Section -->
    <section id="globe-section"
        style="padding: 4rem 0; text-align: center; background: linear-gradient(180deg, transparent, rgba(56, 189, 248, 0.05));">
        <h2 class="section-title reveal" style="margin-bottom: 1rem;">Thank You For Visiting!</h2>
        <p
            style="color: var(--text-secondary); margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
            Passionate about leveraging technology for environmental impact and renewable energy solutions.
        </p>
        <div id="globeContainer" style="width: 100%; height: 500px; cursor: grab;"></div>
    </section>

    <!-- Three.js 3-Stage Globe Script -->
    <script>
            (function () {
                const container = document.getElementById('globeContainer');
                if (!container) return;

                // Scene setup
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(60, container.offsetWidth / 500, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
                renderer.setSize(container.offsetWidth, 500);
                renderer.setPixelRatio(window.devicePixelRatio);
                container.appendChild(renderer.domElement);

                const radius = 6;
                const icoDetail = 5;

                // Noise for continents
                function noise3D(x, y, z) {
                    const n = Math.sin(x * 12.9898 + y * 78.233 + z * 37.719) * 43758.5453;
                    return (n - Math.floor(n)) * 2 - 1;
                }
                function fbm(x, y, z) {
                    let value = 0, amplitude = 0.5, frequency = 1;
                    for (let i = 0; i < 4; i++) {
                        value += amplitude * noise3D(x * frequency, y * frequency, z * frequency);
                        amplitude *= 0.5; frequency *= 2;
                    }
                    return value;
                }

                // ===== SOLID MESH with per-vertex alpha =====
                const solidGeo = new THREE.IcosahedronGeometry(radius, icoDetail);
                const vertexCount = solidGeo.attributes.position.count;
                const faceCount = vertexCount / 3;

                const solidColors = new Float32Array(vertexCount * 4); // RGBA
                const earthColors = new Float32Array(vertexCount * 4);
                const currentColors = new Float32Array(vertexCount * 4);
                const faceRevealOrder = new Float32Array(vertexCount); // When each vertex reveals

                const cyanColor = new THREE.Color(0x22d3ee);
                const purpleColor = new THREE.Color(0xa855f7);
                const deepOceanColor = new THREE.Color(0x0a4c7a);
                const shallowOceanColor = new THREE.Color(0x1e90ff);
                const landColor = new THREE.Color(0x228b22);
                const highlandColor = new THREE.Color(0x2d5a27);
                const iceColor = new THREE.Color(0xf5f5f5);
                const desertColor = new THREE.Color(0xc19a6b);

                const positions = solidGeo.attributes.position.array;

                // Calculate reveal order for each face (based on position - spiral from top)
                for (let face = 0; face < faceCount; face++) {
                    const i0 = face * 3, i1 = face * 3 + 1, i2 = face * 3 + 2;

                    // Face center
                    const cx = (positions[i0 * 3] + positions[i1 * 3] + positions[i2 * 3]) / 3;
                    const cy = (positions[i0 * 3 + 1] + positions[i1 * 3 + 1] + positions[i2 * 3 + 1]) / 3;
                    const cz = (positions[i0 * 3 + 2] + positions[i1 * 3 + 2] + positions[i2 * 3 + 2]) / 3;

                    // Reveal order: spiral from top (based on Y + angle)
                    const angle = Math.atan2(cz, cx);
                    const normalizedY = (cy + radius) / (2 * radius); // 0 at bottom, 1 at top
                    const revealT = (1 - normalizedY) + (angle + Math.PI) / (2 * Math.PI) * 0.3;

                    // Assign same reveal time to all 3 vertices of this face
                    faceRevealOrder[i0] = revealT;
                    faceRevealOrder[i1] = revealT;
                    faceRevealOrder[i2] = revealT;
                }

                // Normalize reveal order to 0-1
                let minR = Infinity, maxR = -Infinity;
                for (let i = 0; i < vertexCount; i++) {
                    minR = Math.min(minR, faceRevealOrder[i]);
                    maxR = Math.max(maxR, faceRevealOrder[i]);
                }
                for (let i = 0; i < vertexCount; i++) {
                    faceRevealOrder[i] = (faceRevealOrder[i] - minR) / (maxR - minR);
                }

                // Set up colors
                for (let i = 0; i < vertexCount; i++) {
                    const x = positions[i * 3];
                    const y = positions[i * 3 + 1];
                    const z = positions[i * 3 + 2];
                    const lat = y / radius;
                    const t = (lat + 1) / 2;

                    // Solid colors (purple to cyan)
                    const sColor = purpleColor.clone().lerp(cyanColor, t);
                    solidColors[i * 4] = sColor.r;
                    solidColors[i * 4 + 1] = sColor.g;
                    solidColors[i * 4 + 2] = sColor.b;
                    solidColors[i * 4 + 3] = 1;

                    // Earth colors
                    let eColor;
                    const absLat = Math.abs(lat);
                    if (absLat > 0.85) {
                        eColor = iceColor;
                    } else {
                        const noiseVal = fbm(x * 0.5, y * 0.5, z * 0.5);
                        if (noiseVal > 0.1) {
                            if (absLat > 0.6) eColor = highlandColor;
                            else if (absLat < 0.2 && noiseVal > 0.3) eColor = desertColor;
                            else eColor = landColor;
                        } else if (noiseVal > -0.1) eColor = shallowOceanColor;
                        else eColor = deepOceanColor;
                    }
                    earthColors[i * 4] = eColor.r;
                    earthColors[i * 4 + 1] = eColor.g;
                    earthColors[i * 4 + 2] = eColor.b;
                    earthColors[i * 4 + 3] = 1;

                    // Start transparent
                    currentColors[i * 4] = solidColors[i * 4];
                    currentColors[i * 4 + 1] = solidColors[i * 4 + 1];
                    currentColors[i * 4 + 2] = solidColors[i * 4 + 2];
                    currentColors[i * 4 + 3] = 0;
                }

                solidGeo.setAttribute('color', new THREE.BufferAttribute(currentColors, 4));

                const solidMaterial = new THREE.MeshBasicMaterial({
                    vertexColors: true,
                    transparent: true,
                    side: THREE.DoubleSide
                });
                const solidMesh = new THREE.Mesh(solidGeo, solidMaterial);
                scene.add(solidMesh);

                // ===== WIREFRAMES =====
                const outerWireGeo = new THREE.IcosahedronGeometry(radius * 1.02, 3);
                const outerWireMat = new THREE.MeshBasicMaterial({ color: 0x22d3ee, wireframe: true, transparent: true, opacity: 0.9 });
                const outerWireframe = new THREE.Mesh(outerWireGeo, outerWireMat);
                scene.add(outerWireframe);

                const midWireGeo = new THREE.IcosahedronGeometry(radius * 0.85, 2);
                const midWireMat = new THREE.MeshBasicMaterial({ color: 0x818cf8, wireframe: true, transparent: true, opacity: 0.6 });
                const midWireframe = new THREE.Mesh(midWireGeo, midWireMat);
                scene.add(midWireframe);

                const innerWireGeo = new THREE.IcosahedronGeometry(radius * 0.6, 1);
                const innerWireMat = new THREE.MeshBasicMaterial({ color: 0xa855f7, wireframe: true, transparent: true, opacity: 0.4 });
                const innerWireframe = new THREE.Mesh(innerWireGeo, innerWireMat);
                scene.add(innerWireframe);

                camera.position.z = 14;

                // ===== ANIMATION TIMING =====
                const stage1Duration = 3;   // Wireframe only
                const stage2Duration = 2.5; // Triangle construction
                const stage3Duration = 4;   // Earth colors
                const totalDuration = stage1Duration + stage2Duration + stage3Duration;

                let startTime = null;
                let isInView = false;

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting && !isInView) {
                            isInView = true;
                            startTime = performance.now();
                        }
                    });
                }, { threshold: 0.3 });
                observer.observe(container);

                let mouseX = 0, mouseY = 0;
                container.addEventListener('mousemove', (e) => {
                    const rect = container.getBoundingClientRect();
                    mouseX = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                    mouseY = ((e.clientY - rect.top) / rect.height) * 2 - 1;
                });

                function animate() {
                    requestAnimationFrame(animate);

                    if (isInView && startTime) {
                        const elapsed = (performance.now() - startTime) / 1000;
                        const colorAttr = solidGeo.attributes.color;

                        // STAGE 1: Wireframe only
                        if (elapsed < stage1Duration) {
                            outerWireMat.opacity = 0.9;
                            midWireMat.opacity = 0.6;
                            innerWireMat.opacity = 0.4;
                            // Keep solid invisible
                            for (let i = 0; i < vertexCount; i++) {
                                colorAttr.array[i * 4 + 3] = 0;
                            }
                            colorAttr.needsUpdate = true;
                        }
                        // STAGE 2: Triangle-by-triangle construction
                        else if (elapsed < stage1Duration + stage2Duration) {
                            const t = (elapsed - stage1Duration) / stage2Duration;

                            // Fade wireframes
                            outerWireMat.opacity = 0.9 * (1 - t * 0.7);
                            midWireMat.opacity = 0.6 * (1 - t * 0.7);
                            innerWireMat.opacity = 0.4 * (1 - t * 0.7);

                            // Progressive triangle reveal
                            for (let i = 0; i < vertexCount; i++) {
                                const threshold = faceRevealOrder[i];
                                if (t > threshold) {
                                    // Face is revealed - snap to full opacity
                                    colorAttr.array[i * 4] = solidColors[i * 4];
                                    colorAttr.array[i * 4 + 1] = solidColors[i * 4 + 1];
                                    colorAttr.array[i * 4 + 2] = solidColors[i * 4 + 2];
                                    colorAttr.array[i * 4 + 3] = 0.95;
                                } else {
                                    colorAttr.array[i * 4 + 3] = 0;
                                }
                            }
                            colorAttr.needsUpdate = true;
                        }
                        // STAGE 3: Transform to Earth colors
                        else if (elapsed < totalDuration) {
                            const t = (elapsed - stage1Duration - stage2Duration) / stage3Duration;
                            const eased = 1 - Math.pow(1 - t, 3);

                            outerWireMat.opacity = 0.27 * (1 - eased);
                            midWireMat.opacity = 0.18 * (1 - eased);
                            innerWireMat.opacity = 0.12 * (1 - eased);

                            for (let i = 0; i < vertexCount; i++) {
                                colorAttr.array[i * 4] = solidColors[i * 4] + (earthColors[i * 4] - solidColors[i * 4]) * eased;
                                colorAttr.array[i * 4 + 1] = solidColors[i * 4 + 1] + (earthColors[i * 4 + 1] - solidColors[i * 4 + 1]) * eased;
                                colorAttr.array[i * 4 + 2] = solidColors[i * 4 + 2] + (earthColors[i * 4 + 2] - solidColors[i * 4 + 2]) * eased;
                                colorAttr.array[i * 4 + 3] = 0.95;
                            }
                            colorAttr.needsUpdate = true;
                        }
                        else {
                            outerWireMat.opacity = 0;
                            midWireMat.opacity = 0;
                            innerWireMat.opacity = 0;
                        }
                    }

                    // Auto rotation
                    solidMesh.rotation.y += 0.003;
                    outerWireframe.rotation.y += 0.003;
                    midWireframe.rotation.y += 0.002;
                    innerWireframe.rotation.y -= 0.002;

                    // Mouse influence
                    const targetRotX = mouseY * 0.3;
                    solidMesh.rotation.x += (targetRotX - solidMesh.rotation.x) * 0.03;
                    outerWireframe.rotation.x += (targetRotX - outerWireframe.rotation.x) * 0.03;
                    midWireframe.rotation.x += (targetRotX - midWireframe.rotation.x) * 0.03;
                    innerWireframe.rotation.x += (targetRotX - innerWireframe.rotation.x) * 0.03;

                    renderer.render(scene, camera);
                }

                animate();

                window.addEventListener('resize', () => {
                    camera.aspect = container.offsetWidth / 500;
                    camera.updateProjectionMatrix();
                    renderer.setSize(container.offsetWidth, 500);
                });
            })();
    </script>

    <!-- Particle Animation Script -->
    <script>
        // Particle Canvas - Electron Constellation / Eco Leaves
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');

        let particles = [];
        const particleCount = 100;
        const connectionDistance = 150;
        const techColors = ['#38bdf8', '#818cf8', '#a855f7', '#22d3ee'];
        const ecoColors = ['#84cc16', '#10b981', '#22c55e', '#34d399'];

        function getColors() {
            return document.body.classList.contains('eco-mode') ? ecoColors : techColors;
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 0.8;
                this.vy = (Math.random() - 0.5) * 0.8;
                this.radius = Math.random() * 3 + 2;
                this.colorIndex = Math.floor(Math.random() * 4);
                this.alpha = Math.random() * 0.6 + 0.4;
                this.rotation = Math.random() * Math.PI * 2;
                this.rotationSpeed = (Math.random() - 0.5) * 0.02;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.rotation += this.rotationSpeed;

                // Bounce off edges
                if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
            }

            draw() {
                const colors = getColors();
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = colors[this.colorIndex];

                if (document.body.classList.contains('eco-mode')) {
                    // Draw leaf shape
                    ctx.save();
                    ctx.translate(this.x, this.y);
                    ctx.rotate(this.rotation);
                    ctx.beginPath();
                    ctx.moveTo(0, -this.radius * 2);
                    ctx.quadraticCurveTo(this.radius * 1.5, -this.radius, 0, this.radius * 2);
                    ctx.quadraticCurveTo(-this.radius * 1.5, -this.radius, 0, -this.radius * 2);
                    ctx.fill();
                    ctx.restore();
                } else {
                    // Draw circle
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.globalAlpha = 1;
            }
        }

        function initParticles() {
            particles = [];
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
        }

        function drawConnections() {
            const isEco = document.body.classList.contains('eco-mode');
            const lineColor = isEco ? '132, 204, 22' : '56, 189, 248';
            const sparkColor1 = isEco ? '132, 204, 22' : '56, 189, 248';
            const sparkColor2 = isEco ? '16, 185, 129' : '168, 85, 247';

            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < connectionDistance) {
                        const opacity = (1 - distance / connectionDistance) * 0.6;
                        ctx.beginPath();
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.strokeStyle = `rgba(${lineColor}, ${opacity})`;
                        ctx.lineWidth = 1;
                        ctx.stroke();

                        // Spark effect at midpoint for very close particles
                        if (distance < 60 && Math.random() > 0.7) {
                            const midX = (particles[i].x + particles[j].x) / 2;
                            const midY = (particles[i].y + particles[j].y) / 2;
                            const sparkSize = (1 - distance / 60) * 6 + 2;

                            // Draw spark glow
                            const gradient = ctx.createRadialGradient(midX, midY, 0, midX, midY, sparkSize * 2);
                            gradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');
                            gradient.addColorStop(0.3, `rgba(${sparkColor1}, 0.6)`);
                            gradient.addColorStop(1, `rgba(${sparkColor2}, 0)`);

                            ctx.beginPath();
                            ctx.arc(midX, midY, sparkSize * 2, 0, Math.PI * 2);
                            ctx.fillStyle = gradient;
                            ctx.fill();
                        }
                    }
                }
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            particles.forEach(particle => {
                particle.update();
                particle.draw();
            });

            drawConnections();
            requestAnimationFrame(animate);
        }

        // Initialize
        resizeCanvas();
        initParticles();
        animate();

        window.addEventListener('resize', () => {
            resizeCanvas();
            initParticles();
        });

        // Scroll Reveal Animation using Intersection Observer
        const revealElements = document.querySelectorAll('.reveal, .reveal-stagger');

        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('revealed');
                }
            });
        }, {
            threshold: 0.15, // Trigger when 15% of element is visible
            rootMargin: '0px 0px -50px 0px' // Slightly before fully in view
        });

        revealElements.forEach(el => revealObserver.observe(el));

        // Circuit Animation for Experience Cards - PCB Style
        const experienceCards = document.querySelectorAll('.experience-card');

        experienceCards.forEach(card => {
            let hoverTimer;

            // Create SVG circuit overlay
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.classList.add('circuit-overlay');
            svg.setAttribute('viewBox', '0 0 100 100');
            svg.setAttribute('preserveAspectRatio', 'none');

            card.appendChild(svg);

            card.addEventListener('mouseenter', () => {
                hoverTimer = setTimeout(() => {
                    generatePCBPattern(svg);
                    card.classList.add('circuit-active');
                }, 1500);
            });

            card.addEventListener('mouseleave', () => {
                clearTimeout(hoverTimer);
                card.classList.remove('circuit-active');
                // Clear paths after short delay for fade out
                setTimeout(() => {
                    const paths = svg.querySelectorAll('.circuit-wire, .circuit-node');
                    paths.forEach(p => p.remove());
                }, 500);
            });
        });

        function generatePCBPattern(svg) {
            // Clear existing elements
            svg.innerHTML = '';

            // Generate 25 random PCB traces
            for (let i = 0; i < 25; i++) {
                const path = createPCBTrace();
                svg.appendChild(path);
            }

            // Add horizontal parallel trace groups (like bus lines)
            for (let i = 0; i < 4; i++) {
                const y = 15 + i * 20 + Math.random() * 10;
                for (let j = 0; j < 3; j++) {
                    const path = createHorizontalTrace(y + j * 2);
                    svg.appendChild(path);
                }
            }

            // Add vertical parallel trace groups
            for (let i = 0; i < 3; i++) {
                const x = 20 + i * 25 + Math.random() * 10;
                for (let j = 0; j < 2; j++) {
                    const path = createVerticalTrace(x + j * 2);
                    svg.appendChild(path);
                }
            }

            // Add random nodes/vias
            for (let i = 0; i < 20; i++) {
                const node = createNode(
                    5 + Math.random() * 90,
                    5 + Math.random() * 90,
                    Math.random() > 0.4
                );
                svg.appendChild(node);
            }
        }

        function createHorizontalTrace(y) {
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.classList.add('circuit-wire', 'thin');
            const startX = Math.random() * 30;
            const endX = 70 + Math.random() * 30;
            path.setAttribute('d', `M ${startX} ${y} L ${endX} ${y}`);
            return path;
        }

        function createVerticalTrace(x) {
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.classList.add('circuit-wire', 'thin');
            const startY = Math.random() * 30;
            const endY = 70 + Math.random() * 30;
            path.setAttribute('d', `M ${x} ${startY} L ${x} ${endY}`);
            return path;
        }

        function createPCBTrace() {
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.classList.add('circuit-wire');
            if (Math.random() > 0.5) path.classList.add('thin');

            // Start from a random edge
            let x, y;
            const edge = Math.floor(Math.random() * 4);

            switch (edge) {
                case 0: x = Math.random() * 100; y = 0; break; // top
                case 1: x = Math.random() * 100; y = 100; break; // bottom
                case 2: x = 0; y = Math.random() * 100; break; // left
                case 3: x = 100; y = Math.random() * 100; break; // right
            }

            // Create path with mixed segments: horizontal, vertical, and 45-degree angles
            let d = `M ${x.toFixed(1)} ${y.toFixed(1)}`;
            const segments = 2 + Math.floor(Math.random() * 4);

            for (let i = 0; i < segments; i++) {
                const length = 10 + Math.random() * 25;
                const direction = Math.floor(Math.random() * 8); // 8 directions

                // Variable angle between 25-45 degrees (0.42 to 0.71 ratio)
                const angleRatio = 0.42 + Math.random() * 0.29;

                switch (direction) {
                    case 0: x += length; break; // right
                    case 1: x -= length; break; // left
                    case 2: y += length; break; // down
                    case 3: y -= length; break; // up
                    case 4: x += length * angleRatio; y += length * angleRatio; break; // diagonal down-right
                    case 5: x -= length * angleRatio; y += length * angleRatio; break; // diagonal down-left
                    case 6: x += length * angleRatio; y -= length * angleRatio; break; // diagonal up-right
                    case 7: x -= length * angleRatio; y -= length * angleRatio; break; // diagonal up-left
                }

                // Keep within bounds
                x = Math.max(2, Math.min(98, x));
                y = Math.max(2, Math.min(98, y));

                d += ` L ${x.toFixed(1)} ${y.toFixed(1)}`;
            }

            path.setAttribute('d', d);
            return path;
        }

        function createNode(x, y, filled) {
            const node = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            node.classList.add('circuit-node');
            if (filled) node.classList.add('filled');
            node.setAttribute('cx', x.toFixed(1));
            node.setAttribute('cy', y.toFixed(1));
            node.setAttribute('r', filled ? '1' : '1.5');
            return node;
        }

        // Scroll Progress Indicator
        const scrollProgress = document.getElementById('scrollProgress');

        window.addEventListener('scroll', () => {
            const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercent = (scrollTop / scrollHeight) * 100;
            scrollProgress.style.width = scrollPercent + '%';
        });

        // Card Pickup Animation - intercept project card link clicks
        document.querySelectorAll('.project-card .btn').forEach(btn => {
            btn.addEventListener('click', function (e) {
                e.preventDefault();
                const href = this.getAttribute('href');
                const target = this.getAttribute('target');
                const card = this.closest('.project-card');

                if (card && !card.classList.contains('card-flying')) {
                    // Add flying class to trigger animation
                    card.classList.add('card-flying');

                    // Navigate after animation completes
                    setTimeout(() => {
                        if (target === '_blank') {
                            window.open(href, '_blank');
                        } else {
                            window.location.href = href;
                        }
                        // Reset card after navigation (for back button)
                        setTimeout(() => {
                            card.classList.remove('card-flying');
                        }, 100);
                    }, 700);
                }
            });
        });

        // Theme Toggle (Tech Mode / Eco Mode)
        const themeToggle = document.getElementById('themeToggle');
        const toggleIcon = themeToggle.querySelector('.toggle-icon');
        const toggleLabel = themeToggle.querySelector('.toggle-label');

        // Load saved theme preference
        if (localStorage.getItem('theme') === 'eco') {
            document.body.classList.add('eco-mode');
            toggleIcon.textContent = 'ðŸŒ±';
            toggleLabel.textContent = 'Eco';
        }

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('eco-mode');
            const isEco = document.body.classList.contains('eco-mode');

            toggleIcon.textContent = isEco ? 'ðŸŒ±' : 'ðŸŒ™';
            toggleLabel.textContent = isEco ? 'Eco' : 'Mode';

            localStorage.setItem('theme', isEco ? 'eco' : 'tech');
        });

        // Live Clock - Pasadena Time
        function updateClock() {
            const now = new Date();
            const options = {
                timeZone: 'America/Los_Angeles',
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            };
            const timeString = now.toLocaleTimeString('en-US', options);
            document.getElementById('liveClock').textContent = timeString;
        }
        updateClock();
        setInterval(updateClock, 1000);

        // Copy to Clipboard Function
        function copyToClipboard(text, element) {
            navigator.clipboard.writeText(text).then(() => {
                // Show copied feedback
                const icon = element.querySelector('i');
                const originalClass = icon.className;
                icon.className = 'fa-solid fa-check';
                element.style.color = '#22c55e';

                setTimeout(() => {
                    icon.className = originalClass;
                    element.style.color = '';
                }, 1500);
            });
        }
    </script>
</body>

</html>